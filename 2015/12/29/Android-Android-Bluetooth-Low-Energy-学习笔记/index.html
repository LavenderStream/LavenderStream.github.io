<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="#Android Bluetooth Low Energy 基础 1、关于Android平台的BLE 蓝牙4.0于2010年发布，相对于上个版本3.0，它的特点是更省电、成本低 延迟低等特点，现在最新的蓝牙协议是2013年底发布的蓝牙4.1，蓝牙4.1在4.0 基础上进行升级，使得可穿戴设备的批量数据传输速度更高。Android是从4.3 才开始提供BLE API,这也就限定了BLE的应用只能运行">
<meta name="keywords" content="android javascript">
<meta property="og:type" content="article">
<meta property="og:title" content="Android -- Android Bluetooth Low Energy 学习笔记">
<meta property="og:url" content="https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/index.html">
<meta property="og:site_name" content="Tiny hexo">
<meta property="og:description" content="#Android Bluetooth Low Energy 基础 1、关于Android平台的BLE 蓝牙4.0于2010年发布，相对于上个版本3.0，它的特点是更省电、成本低 延迟低等特点，现在最新的蓝牙协议是2013年底发布的蓝牙4.1，蓝牙4.1在4.0 基础上进行升级，使得可穿戴设备的批量数据传输速度更高。Android是从4.3 才开始提供BLE API,这也就限定了BLE的应用只能运行">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1285832-a69e3e90f24e5fbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-10-27T03:12:38.262Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android -- Android Bluetooth Low Energy 学习笔记">
<meta name="twitter:description" content="#Android Bluetooth Low Energy 基础 1、关于Android平台的BLE 蓝牙4.0于2010年发布，相对于上个版本3.0，它的特点是更省电、成本低 延迟低等特点，现在最新的蓝牙协议是2013年底发布的蓝牙4.1，蓝牙4.1在4.0 基础上进行升级，使得可穿戴设备的批量数据传输速度更高。Android是从4.3 才开始提供BLE API,这也就限定了BLE的应用只能运行">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/1285832-a69e3e90f24e5fbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Android -- Android Bluetooth Low Energy 学习笔记</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://www.jianshu.com/u/4215db84d54e">JianShu</a></li>
         
          <li><a href="https://github.com/LavenderStream">GitHub</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2016/01/05/AndroidStudio/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2015/12/29/Arduino-lcd/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&text=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&is_video=false&description=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Android -- Android Bluetooth Low Energy 学习笔记&body=Check out this article: https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&name=Android -- Android Bluetooth Low Energy 学习笔记&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Android-Bluetooth-Low-Energy-数据的写入与读取-第二天"><span class="toc-number">1.</span> <span class="toc-text">Android Bluetooth Low Energy 数据的写入与读取 第二天</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Android -- Android Bluetooth Low Energy 学习笔记
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">Tiny</span>
      </span>
      
    <div class="postdate">
        <time datetime="2015-12-29T11:05:59.000Z" itemprop="datePublished">2015-12-29</time>
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>#Android Bluetooth Low Energy 基础</p>
<p>1、关于Android平台的BLE</p>
<p>蓝牙4.0于2010年发布，相对于上个版本3.0，它的特点是更省电、成本低 延迟低等特点，现在最新的蓝牙协议是2013年底发布的蓝牙4.1，蓝牙4.1在4.0 基础上进行升级，使得可穿戴设备的批量数据传输速度更高。Android是从4.3 才开始提供BLE API,这也就限定了BLE的应用只能运行在Android 4.3及其以上 的系统。在Android平台上的蓝牙4.0主要有两种工作模式:经典蓝牙(classic bluetooth) 、低功耗蓝牙(bluetooth low energy,缩写为BLE)</p>
<p>2、角色与职责</p>
<p> 当一个Android设备与一个BLE设备进行交互通信时，主要存在以下两种关系<br>中心设备与外围设备：中心设备扮演扫描的角色，寻找外围设备的广播消息。Android设备 作为中心设备，与之连接通信的设备作为外围设备。</p>
<p>GATT服务器与GATT客户端：这种关系决定了当连接建立后两个设备如何通信。</p>
<p>注：目前Android系统提供的API使得Android设备只能作为中心设备</p>
<p>3、组成部分</p>
<p> BLE分为三个部分Service、Characteristic、Descriptor，每个部分都拥有不同的 UUID来标识。一个BLE设备可以拥有多个Service，一个Service可以包含多个Characteristic， 一个Characteristic包含一个Value和多个Descriptor，一个Descriptor包含一个Value。 通信数据一般存储在Characteristic内，目前一个Characteristic中存储的数据最大为20 byte。 与Characteristic相关的权限字段主要有READ、WRITE、WRITE_NO_RESPONSE、NOTIFY。 Characteristic具有的权限属性可以有一个或者多个。</p>
<p>4、核心代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private BluetoothAdapter mBtAdapter = null;</span><br><span class="line">private BluetoothGatt mBtGatt = null;</span><br><span class="line">private int mState = 0;</span><br><span class="line">private Context mContext;</span><br><span class="line">private BluetoothGattCharacteristic mWriteCharacteristic = null;</span><br><span class="line">private BluetoothGattCharacteristic mReadCharacteristric = null;</span><br><span class="line"> </span><br><span class="line">private final String TAG = &quot;BLE_Demo&quot;;</span><br><span class="line"> </span><br><span class="line">// 设备连接状态</span><br><span class="line">private final int CONNECTED = 0x01;</span><br><span class="line">private final int DISCONNECTED = 0x02;</span><br><span class="line">private final int CONNECTTING = 0x03;</span><br><span class="line"> </span><br><span class="line">// 读写相关的Service、Characteristic的UUID</span><br><span class="line">public static final UUID TRANSFER_SERVICE_READ = UUID.fromString(&quot;34567817-2432-5678-1235-3c1d5ab44e17&quot;);</span><br><span class="line">public static final UUID TRANSFER_SERVICE_WRITE = UUID.fromString(&quot;34567817-2432-5678-1235-3c1d5ab44e18&quot;);</span><br><span class="line">public static final UUID TRANSFER_CHARACTERISTIC_READ = UUID.fromString(&quot;23487654-5678-1235-2432-3c1d5ab44e94&quot;);</span><br><span class="line">public static final UUID TRANSFER_CHARACTERISTIC_WRITE = UUID.fromString(&quot;23487654-5678-1235-2432-3c1d5ab44e93&quot;);</span><br><span class="line"> </span><br><span class="line">// BLE设备连接通信过程中回调</span><br><span class="line">private BluetoothGattCallback mBtGattCallback = new BluetoothGattCallback() &#123;</span><br><span class="line"> </span><br><span class="line">    // 连接状态发生改变时的回调</span><br><span class="line">    @Override</span><br><span class="line">    public void onConnectionStateChange(BluetoothGatt gatt, int status,</span><br><span class="line">                int newState) &#123;</span><br><span class="line"> </span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            mState = CONNECTED;</span><br><span class="line">            Log.d(TAG, &quot;connected OK&quot;);</span><br><span class="line">            mBtGatt.discoverServices();</span><br><span class="line">        &#125; else if (newState == BluetoothGatt.GATT_FAILURE) &#123;</span><br><span class="line">            mState = DISCONNECTED;</span><br><span class="line">            Log.d(TAG, &quot;connect failed&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 远端设备中的服务可用时的回调</span><br><span class="line">    @Override</span><br><span class="line">    public void onServicesDiscovered(BluetoothGatt gatt, int status) &#123;</span><br><span class="line"> </span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            BluetoothGattService btGattWriteService = mBtGatt</span><br><span class="line">                    .getService(TRANSFER_SERVICE_WRITE);</span><br><span class="line">            BluetoothGattService btGattReadService = mBtGatt</span><br><span class="line">                    .getService(TRANSFER_SERVICE_READ);</span><br><span class="line">            if (btGattWriteService != null) &#123;</span><br><span class="line">                mWriteCharacteristic = btGattWriteService</span><br><span class="line">                        .getCharacteristic(TRANSFER_CHARACTERISTIC_WRITE);</span><br><span class="line">            &#125;</span><br><span class="line">            if (btGattReadService != null) &#123;</span><br><span class="line">                mReadCharacteristric = btGattReadService</span><br><span class="line">                        .getCharacteristic(TRANSFER_CHARACTERISTIC_READ);</span><br><span class="line">                if (mReadCharacteristric != null) &#123;</span><br><span class="line">                    mBtGatt.readCharacteristic(mReadCharacteristric);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 某Characteristic的状态为可读时的回调</span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicRead(BluetoothGatt gatt,</span><br><span class="line">            BluetoothGattCharacteristic characteristic, int status) &#123;</span><br><span class="line"> </span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            readCharacterisricValue(characteristic);</span><br><span class="line"> </span><br><span class="line">            // 订阅远端设备的characteristic，</span><br><span class="line">            // 当此characteristic发生改变时当回调mBtGattCallback中的onCharacteristicChanged方法</span><br><span class="line">            mBtGatt.setCharacteristicNotification(mReadCharacteristric,</span><br><span class="line">                    true);</span><br><span class="line">            BluetoothGattDescriptor descriptor = mReadCharacteristric</span><br><span class="line">                    .getDescriptor(UUID</span><br><span class="line">                            .fromString(&quot;00002902-0000-1000-8000-00805f9b34fb&quot;));</span><br><span class="line">            if (descriptor != null) &#123;</span><br><span class="line">                byte[] val = BluetoothGattDescriptor.ENABLE_NOTIFICATION_VALUE;</span><br><span class="line">                descriptor.setValue(val);</span><br><span class="line">                mBtGatt.writeDescriptor(descriptor);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 写入Characteristic成功与否的回调</span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicWrite(BluetoothGatt gatt,</span><br><span class="line">            BluetoothGattCharacteristic characteristic, int status) &#123;</span><br><span class="line"> </span><br><span class="line">        switch (status) &#123;</span><br><span class="line">        case BluetoothGatt.GATT_SUCCESS:</span><br><span class="line">            Log.d(TAG, &quot;write data success&quot;);</span><br><span class="line">            break;// 写入成功</span><br><span class="line">        case BluetoothGatt.GATT_FAILURE:</span><br><span class="line">            Log.d(TAG, &quot;write data failed&quot;);</span><br><span class="line">            break;// 写入失败</span><br><span class="line">        case BluetoothGatt.GATT_WRITE_NOT_PERMITTED:</span><br><span class="line">            Log.d(TAG, &quot;write not permitted&quot;);</span><br><span class="line">            break;// 没有写入的权限</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 订阅了远端设备的Characteristic信息后，</span><br><span class="line">    // 当远端设备的Characteristic信息发生改变后,回调此方法</span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicChanged(BluetoothGatt gatt,</span><br><span class="line">            BluetoothGattCharacteristic characteristic) &#123;</span><br><span class="line">        readCharacterisricValue(characteristic);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 读取BluetoothGattCharacteristic中的数据</span><br><span class="line"> * </span><br><span class="line"> * @param characteristic</span><br><span class="line"> */</span><br><span class="line">private void readCharacterisricValue(</span><br><span class="line">        BluetoothGattCharacteristic characteristic) &#123;</span><br><span class="line">    byte[] data = characteristic.getValue();</span><br><span class="line">    StringBuffer buffer = new StringBuffer(&quot;0x&quot;);</span><br><span class="line">    int i;</span><br><span class="line">    for (byte b : data) &#123;</span><br><span class="line">        i = b &amp; 0xff;</span><br><span class="line">        buffer.append(Integer.toHexString(i));</span><br><span class="line">    &#125;</span><br><span class="line">    Log.d(TAG, &quot;read data:&quot; + buffer.toString());</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 与指定的设备建立连接</span><br><span class="line"> * </span><br><span class="line"> * @param device</span><br><span class="line"> */</span><br><span class="line">public void connect(BluetoothDevice device) &#123;</span><br><span class="line"> </span><br><span class="line">    mBtGatt = device.connectGatt(mContext, false, mBtGattCallback);</span><br><span class="line">    mState = CONNECTTING;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 初始化</span><br><span class="line"> * </span><br><span class="line"> * @param context</span><br><span class="line"> * @return 如果初始化成功则返回true</span><br><span class="line"> */</span><br><span class="line">public boolean init(Context context) &#123;</span><br><span class="line">    BluetoothManager btMrg = (BluetoothManager) context</span><br><span class="line">            .getSystemService(Context.BLUETOOTH_SERVICE);</span><br><span class="line">    if (btMrg == null)</span><br><span class="line">        return false;</span><br><span class="line">    mBtAdapter = btMrg.getAdapter();</span><br><span class="line">    if (mBtAdapter == null)</span><br><span class="line">        return false;</span><br><span class="line">    mContext = context;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// BLE设备搜索过程中的回调，在此可以根据外围设备广播的消息来对设备进行过滤</span><br><span class="line">private BluetoothAdapter.LeScanCallback mLeScanCallback = new BluetoothAdapter.LeScanCallback() &#123;</span><br><span class="line">     </span><br><span class="line">    @Override</span><br><span class="line">    public void onLeScan(final BluetoothDevice device, int rssi,</span><br><span class="line">            byte[] scanRecord) &#123;</span><br><span class="line">         </span><br><span class="line">        ArrayUtils.reverse(scanRecord);// 数组反转</span><br><span class="line">        // 将Byte数组的数据以十六进制表示并拼接成字符串</span><br><span class="line">        StringBuffer str = new StringBuffer();</span><br><span class="line">        int i = 0;</span><br><span class="line">        for (byte b : scanRecord) &#123;</span><br><span class="line">            i = (b &amp; 0xff);</span><br><span class="line">            str.append(Integer.toHexString(i));</span><br><span class="line">        &#125;</span><br><span class="line">        String discoveryServceID = str.toString();</span><br><span class="line">        Log.d(TAG, device.getName() + &quot; scanRecord:\n&quot; + discoveryServceID);</span><br><span class="line">         </span><br><span class="line">        // 查询是否含有指定的Service UUID信息</span><br><span class="line">        if (discoveryServceID.indexOf(TRANSFER_SERVICE_WRITE.toString()</span><br><span class="line">                .replace(&quot;-&quot;, &quot;&quot;)) != -1) &#123;</span><br><span class="line"> </span><br><span class="line">            Log.d(TAG, device.getName() + &quot; has available service UUID&quot;);</span><br><span class="line"> </span><br><span class="line">            // 在这是处理匹配的设备……</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 开始BLE设备扫描</span><br><span class="line"> */</span><br><span class="line">public void startScan() &#123;</span><br><span class="line">    mBtAdapter.startLeScan(mLeScanCallback);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 停止BLE设备扫描</span><br><span class="line"> */</span><br><span class="line">public void stopScan() &#123;</span><br><span class="line">    mBtAdapter.stopLeScan(mLeScanCallback);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 发送数据</span><br><span class="line"> * </span><br><span class="line"> * @param data</span><br><span class="line"> *            待发送的数据,最大长度为20</span><br><span class="line"> */</span><br><span class="line">private void sendData(byte[] data) &#123;</span><br><span class="line"> </span><br><span class="line">    if (data != null &amp;&amp; data.length &gt; 0 &amp;&amp; data.length &lt; 21) &#123;</span><br><span class="line">        if (mWriteCharacteristic.setValue(data)</span><br><span class="line">                &amp;&amp; mBtGatt.writeCharacteristic(mWriteCharacteristic)) &#123;</span><br><span class="line">            Log.d(TAG, &quot;send data OK&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>#Android Bluetooth Low Energy 数据的写入与读取 第一天<br>1 、启动ble设备连接的方法首先要得到一个BluetoothDevice， 这个可以通过，android搜索一配对或者为配对的蓝牙设备获取得到BluetoothDevice的对象，也可以通过搜索ble设备去得到一个BluetoothDevice的对象（下面会仔细说索搜ble设备）需要注意的是，当一个ble设备作为一个蓝牙设备连接到了android 设备上的话，我们通过搜索ble设备的api是搜索不到的。</p>
<p>2、得到一个蓝牙已配对设备<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();</span><br><span class="line">mBluetoothAdapter.startDiscovery();</span><br><span class="line"> </span><br><span class="line">Set&lt;BluetoothDevice&gt; bledevices = mBluetoothAdapter.getBondedDevices();</span><br><span class="line">if (bledevices.size() &gt; 0)</span><br><span class="line">&#123;</span><br><span class="line">    for (BluetoothDevice bluetoothDevice : bledevices)</span><br><span class="line">    &#123;</span><br><span class="line">        if (bluetoothDevice.getAddress().toString()</span><br><span class="line">                .equals(BLUETOOTH_DEVICE_MAC))</span><br><span class="line">        &#123;</span><br><span class="line">            Log.v(TAG, &quot;find with old: &quot; + bluetoothDevice.getAddress());</span><br><span class="line">            bluetoothDevice.connectGatt(getActivity(), false,</span><br><span class="line">                    mGattCallback);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3、如何索搜ble设备 ：</p>
<pre><code>使用BluetoothAdapter 的 startLeScan 方法， 
</code></pre><p>startLeScan 的参数是一个回调。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private BluetoothAdapter.LeScanCallback mLeScanCallback = new BluetoothAdapter.LeScanCallback()</span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void onLeScan(final BluetoothDevice device, int rssi,</span><br><span class="line">            byte[] scanRecord)</span><br><span class="line">    &#123;</span><br><span class="line">        Log.v(TAG, &quot;device: &quot; + device);   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>在这个回调里可以索搜到BLE设备</p>
<p>4、使用索搜到的设备连接：</p>
<p>当我们搜索到设备的时候， 可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">device.connectGatt(getActivity(), false, mGattCallback);</span><br></pre></td></tr></table></figure></p>
<p>进行连接，其中 mGattCallback 也是个回调方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">private final BluetoothGattCallback mGattCallback = new BluetoothGattCallback()</span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">       // 设备发生读操作时的回调</span><br><span class="line">       @Override</span><br><span class="line">       public void onCharacteristicRead(BluetoothGatt gatt,</span><br><span class="line">               BluetoothGattCharacteristic characteristic, int status)</span><br><span class="line">       &#123;</span><br><span class="line">           Log.v(TAG, &quot;onCharacteristicRead: &quot; + characteristic.getUuid());</span><br><span class="line">       &#125;</span><br><span class="line">                 </span><br><span class="line">       // 设备发生写操作是的回调</span><br><span class="line">       @Override</span><br><span class="line">       public void onCharacteristicWrite(BluetoothGatt gatt,</span><br><span class="line">               BluetoothGattCharacteristic characteristic, int status)</span><br><span class="line">       &#123;</span><br><span class="line">           if (BluetoothGatt.GATT_SUCCESS == status)</span><br><span class="line">           &#123;</span><br><span class="line">               Log.v(TAG, &quot;onCharacteristicWrite: &quot; + characteristic.getUuid());</span><br><span class="line">           &#125;</span><br><span class="line">           super.onCharacteristicWrite(gatt, characteristic, status);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       // 设备连接状态发生更改时的回调</span><br><span class="line">       // 我们要在这里进行discoverServices()</span><br><span class="line">       @Override</span><br><span class="line">       public void onConnectionStateChange(BluetoothGatt gatt, int status,</span><br><span class="line">               int newState)</span><br><span class="line">       &#123;</span><br><span class="line">           gatt.discoverServices();</span><br><span class="line">           super.onConnectionStateChange(gatt, status, newState);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       // 当BLE设备中的服务被找到时，回调如下方法</span><br><span class="line">       @Override</span><br><span class="line">       public void onServicesDiscovered(BluetoothGatt gatt, int status)</span><br><span class="line">       &#123;</span><br><span class="line">           Log.v(TAG, &quot;onServicesDiscovered: &quot; + gatt.getServices().size());</span><br><span class="line"></span><br><span class="line">           super.onServicesDiscovered(gatt, status);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure></p>
<p>5、重点：数据的IO<br>无论数据或是写，都需要</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BluetoothGattService mSVC = gatt.getService(UUID</span><br><span class="line">                    .fromString(&quot;0000dfb0-0000-1000-8000-00805f9b34fb&quot;));</span><br><span class="line">BluetoothGattCharacteristic mCH = mSVC.getCharacteristic(UUID</span><br><span class="line">                    .fromString(&quot;0000dfb1-0000-1000-8000-00805f9b34fb&quot;));</span><br></pre></td></tr></table></figure>
<p>得到一个BluetoothGattCharacteristic ， 如上， 我们同过一个指定uuid的方式，在</p>
<p>public<br> void<br> onServicesDiscovered() 方法中</p>
<p>得到gatt ，调用gatt的读操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatt.readCharacteristic(mCH);</span><br></pre></td></tr></table></figure></p>
<p>执行这部操作之后， 我们会在 onCharacteristicRead 方法回掉这个 Characteristic 的所带有的value</p>
<p>写操作则是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mCH.setValue(GAME_MODE);</span><br><span class="line">gatt.writeCharacteristic(mCH);</span><br></pre></td></tr></table></figure></p>
<p>同理，在 onCharacteristicWrite 方法中可以获得操作的提示。</p>
<pre><code>20151120 ， 目前我可以读到 
</code></pre><p>Characteristic 里的数据，结果也正确， 但是无法语言写入是否正确，目前执行了write的操作，系统显示写入正常， 但是看不到相应的变化，</p>
<p>指环的模式并没有变化。ps：我在提供的demo中执行写操作，指环的状态也为改变（之前改过机会，目前不知道情况）</p>
<h1 id="Android-Bluetooth-Low-Energy-数据的写入与读取-第二天"><a href="#Android-Bluetooth-Low-Energy-数据的写入与读取-第二天" class="headerlink" title="Android Bluetooth Low Energy 数据的写入与读取 第二天"></a>Android Bluetooth Low Energy 数据的写入与读取 第二天</h1><p>1、使用<br> writeCharacteristic 读写数据，（顺便说一句，今天反复的调试之后，公司这边的蓝牙设备终于可以切换模式了，不知道为什么之前尝试的总是不行），今天做下总结。</p>
<p>2、由于android ble 的接口都是异步的， 所以我们所调用的方法都要在回掉函数中进行，写一个简单的流程图， 方便理解：(图画的不专业， 凑合看看)</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1285832-a69e3e90f24e5fbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br>3、写数据的时候将值这样写 ch.setValue(new byte[] { (byte) 0x00, (byte) 0xff });<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br></pre></td><td class="code"><pre><span class="line">package youten.redo.ble.readwrite;</span><br><span class="line"> </span><br><span class="line">import java.util.Set;</span><br><span class="line">import java.util.UUID;</span><br><span class="line"> </span><br><span class="line">import youten.redo.ble.util.BleUtil;</span><br><span class="line">import youten.redo.ble.util.BleUuid;</span><br><span class="line">import android.app.Activity;</span><br><span class="line">import android.bluetooth.BluetoothAdapter;</span><br><span class="line">import android.bluetooth.BluetoothDevice;</span><br><span class="line">import android.bluetooth.BluetoothGatt;</span><br><span class="line">import android.bluetooth.BluetoothGattCallback;</span><br><span class="line">import android.bluetooth.BluetoothGattCharacteristic;</span><br><span class="line">import android.bluetooth.BluetoothGattService;</span><br><span class="line">import android.bluetooth.BluetoothManager;</span><br><span class="line">import android.bluetooth.BluetoothProfile;</span><br><span class="line">import android.content.Intent;</span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.view.Window;</span><br><span class="line">import android.widget.Button;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line"> </span><br><span class="line">public class DeviceActivity extends Activity implements View.OnClickListener</span><br><span class="line">&#123;</span><br><span class="line">    private static final String TAG = &quot;BLEDevice&quot;;</span><br><span class="line"> </span><br><span class="line">    public static final String EXTRA_BLUETOOTH_DEVICE = &quot;BT_DEVICE&quot;;</span><br><span class="line">    private BluetoothAdapter mBTAdapter;</span><br><span class="line">    private BluetoothDevice mDevice;</span><br><span class="line">    private BluetoothGatt mConnGatt;</span><br><span class="line">    private int mStatus;</span><br><span class="line"> </span><br><span class="line">    private Button mReadManufacturerNameButton;</span><br><span class="line">    private Button mReadSerialNumberButton;</span><br><span class="line">    private Button mWriteAlertLevelButton;</span><br><span class="line"> </span><br><span class="line">    private final BluetoothGattCallback mGattcallback = new BluetoothGattCallback()</span><br><span class="line">    &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onConnectionStateChange(BluetoothGatt gatt, int status,</span><br><span class="line">                int newState)</span><br><span class="line">        &#123;</span><br><span class="line">            if (newState == BluetoothProfile.STATE_CONNECTED)</span><br><span class="line">            &#123;</span><br><span class="line">                mStatus = newState;</span><br><span class="line">                Log.v(TAG, &quot;connected and discoverServices&quot;);</span><br><span class="line">                mConnGatt.discoverServices();</span><br><span class="line">            &#125; else if (newState == BluetoothProfile.STATE_DISCONNECTED)</span><br><span class="line">            &#123;</span><br><span class="line">                mStatus = newState;</span><br><span class="line">                runOnUiThread(new Runnable()</span><br><span class="line">                &#123;</span><br><span class="line">                    public void run()</span><br><span class="line">                    &#123;</span><br><span class="line">                        mReadManufacturerNameButton.setEnabled(false);</span><br><span class="line">                        mReadSerialNumberButton.setEnabled(false);</span><br><span class="line">                        mWriteAlertLevelButton.setEnabled(false);</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void onServicesDiscovered(BluetoothGatt gatt, int status)</span><br><span class="line">        &#123;</span><br><span class="line">            Log.v(TAG, &quot;is have services&quot;);</span><br><span class="line">            for (BluetoothGattService service : gatt.getServices())</span><br><span class="line">            &#123;</span><br><span class="line">                if ((service == null) || (service.getUuid() == null))</span><br><span class="line">                &#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line">                if (BleUuid.SERVICE_DEVICE_INFORMATION.equalsIgnoreCase(service</span><br><span class="line">                        .getUuid().toString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    mReadManufacturerNameButton</span><br><span class="line">                            .setTag(service.getCharacteristic(UUID</span><br><span class="line">                                    .fromString(BleUuid.CHAR_MANUFACTURER_NAME_STRING)));</span><br><span class="line">                    mReadSerialNumberButton</span><br><span class="line">                            .setTag(service.getCharacteristic(UUID</span><br><span class="line">                                    .fromString(BleUuid.CHAR_SERIAL_NUMBEAR_STRING)));</span><br><span class="line">                    runOnUiThread(new Runnable()</span><br><span class="line">                    &#123;</span><br><span class="line">                        public void run()</span><br><span class="line">                        &#123;</span><br><span class="line">                            mReadManufacturerNameButton.setEnabled(true);</span><br><span class="line">                            mReadSerialNumberButton.setEnabled(true);</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                if (BleUuid.SERVICE_IMMEDIATE_ALERT.equalsIgnoreCase(service</span><br><span class="line">                        .getUuid().toString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    runOnUiThread(new Runnable()</span><br><span class="line">                    &#123;</span><br><span class="line">                        public void run()</span><br><span class="line">                        &#123;</span><br><span class="line">                            mWriteAlertLevelButton.setEnabled(true);</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    mWriteAlertLevelButton.setTag(service</span><br><span class="line">                            .getCharacteristic(UUID</span><br><span class="line">                                    .fromString(BleUuid.CHAR_ALERT_LEVEL)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            runOnUiThread(new Runnable()</span><br><span class="line">            &#123;</span><br><span class="line">                public void run()</span><br><span class="line">                &#123;</span><br><span class="line">                    setProgressBarIndeterminateVisibility(false);</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void onCharacteristicRead(BluetoothGatt gatt,</span><br><span class="line">                BluetoothGattCharacteristic characteristic, int status)</span><br><span class="line">        &#123;</span><br><span class="line">            if (status == BluetoothGatt.GATT_SUCCESS)</span><br><span class="line">            &#123;</span><br><span class="line"> </span><br><span class="line">                byte[] bytes = characteristic.getValue();</span><br><span class="line">                for (byte b : bytes)</span><br><span class="line">                &#123;</span><br><span class="line">                    Log.v(&quot;&quot;, &quot;------characteristic------&quot; + b);</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                if (BleUuid.CHAR_MANUFACTURER_NAME_STRING</span><br><span class="line">                        .equalsIgnoreCase(characteristic.getUuid().toString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    final String name = characteristic.getStringValue(0);</span><br><span class="line"> </span><br><span class="line">                    runOnUiThread(new Runnable()</span><br><span class="line">                    &#123;</span><br><span class="line">                        public void run()</span><br><span class="line">                        &#123;</span><br><span class="line">                            mReadManufacturerNameButton.setText(name);</span><br><span class="line">                            setProgressBarIndeterminateVisibility(false);</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; else if (BleUuid.CHAR_SERIAL_NUMBEAR_STRING</span><br><span class="line">                        .equalsIgnoreCase(characteristic.getUuid().toString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    final String name = characteristic.getStringValue(0);</span><br><span class="line"> </span><br><span class="line">                    runOnUiThread(new Runnable()</span><br><span class="line">                    &#123;</span><br><span class="line">                        public void run()</span><br><span class="line">                        &#123;</span><br><span class="line">                            mReadSerialNumberButton.setText(name);</span><br><span class="line">                            setProgressBarIndeterminateVisibility(false);</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void onCharacteristicWrite(BluetoothGatt gatt,</span><br><span class="line">                BluetoothGattCharacteristic characteristic, int status)</span><br><span class="line">        &#123;</span><br><span class="line"> </span><br><span class="line">            if (BluetoothGatt.GATT_SUCCESS == status)</span><br><span class="line">            &#123;</span><br><span class="line">                Log.v(TAG,</span><br><span class="line">                        &quot;write - characteristic: &quot; + characteristic.getUuid());</span><br><span class="line">                Log.v(TAG, &quot;write - service &quot;</span><br><span class="line">                        + characteristic.getService().getUuid());</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            // 再读取一次， 验证一下值是不是对的</span><br><span class="line">            gatt.readCharacteristic(characteristic);</span><br><span class="line"> </span><br><span class="line">            runOnUiThread(new Runnable()</span><br><span class="line">            &#123;</span><br><span class="line">                public void run()</span><br><span class="line">                &#123;</span><br><span class="line">                    setProgressBarIndeterminateVisibility(false);</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState)</span><br><span class="line">    &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);</span><br><span class="line">        setContentView(R.layout.activity_device);</span><br><span class="line"> </span><br><span class="line">        // state</span><br><span class="line">        mStatus = BluetoothProfile.STATE_DISCONNECTED;</span><br><span class="line">        mReadManufacturerNameButton = (Button) findViewById(R.id.read_manufacturer_name_button);</span><br><span class="line">        mReadManufacturerNameButton.setOnClickListener(this);</span><br><span class="line">        mReadSerialNumberButton = (Button) findViewById(R.id.read_serial_number_button);</span><br><span class="line">        mReadSerialNumberButton.setOnClickListener(this);</span><br><span class="line">        mWriteAlertLevelButton = (Button) findViewById(R.id.write_alert_level_button);</span><br><span class="line">        mWriteAlertLevelButton.setOnClickListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    protected void onResume()</span><br><span class="line">    &#123;</span><br><span class="line">        super.onResume();</span><br><span class="line"> </span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    protected void onDestroy()</span><br><span class="line">    &#123;</span><br><span class="line">        super.onDestroy();</span><br><span class="line">        if (mConnGatt != null)</span><br><span class="line">        &#123;</span><br><span class="line">            if ((mStatus != BluetoothProfile.STATE_DISCONNECTING)</span><br><span class="line">                    &amp;&amp; (mStatus != BluetoothProfile.STATE_DISCONNECTED))</span><br><span class="line">            &#123;</span><br><span class="line">                mConnGatt.disconnect();</span><br><span class="line">            &#125;</span><br><span class="line">            mConnGatt.close();</span><br><span class="line">            mConnGatt = null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void onClick(View v)</span><br><span class="line">    &#123;</span><br><span class="line">        if (v.getId() == R.id.read_manufacturer_name_button)</span><br><span class="line">        &#123;</span><br><span class="line">            if ((v.getTag() != null)</span><br><span class="line">                    &amp;&amp; (v.getTag() instanceof BluetoothGattCharacteristic))</span><br><span class="line">            &#123;</span><br><span class="line">                BluetoothGattCharacteristic ch = (BluetoothGattCharacteristic) v</span><br><span class="line">                        .getTag();</span><br><span class="line">                if (mConnGatt.readCharacteristic(ch))</span><br><span class="line">                &#123;</span><br><span class="line">                    setProgressBarIndeterminateVisibility(true);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (v.getId() == R.id.read_serial_number_button)</span><br><span class="line">        &#123;</span><br><span class="line">            if ((v.getTag() != null)</span><br><span class="line">                    &amp;&amp; (v.getTag() instanceof BluetoothGattCharacteristic))</span><br><span class="line">            &#123;</span><br><span class="line">                BluetoothGattCharacteristic ch = (BluetoothGattCharacteristic) v</span><br><span class="line">                        .getTag();</span><br><span class="line">                if (mConnGatt.readCharacteristic(ch))</span><br><span class="line">                &#123;</span><br><span class="line">                    setProgressBarIndeterminateVisibility(true);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125; else if (v.getId() == R.id.write_alert_level_button)</span><br><span class="line">        &#123;</span><br><span class="line">            if ((v.getTag() != null)</span><br><span class="line">                    &amp;&amp; (v.getTag() instanceof BluetoothGattCharacteristic))</span><br><span class="line">            &#123;</span><br><span class="line">                BluetoothGattCharacteristic ch = (BluetoothGattCharacteristic) v</span><br><span class="line">                        .getTag();</span><br><span class="line">                ch.setValue(new byte[] &#123; (byte) 0x00, (byte) 0xff &#125;);</span><br><span class="line">                if (mConnGatt.writeCharacteristic(ch))</span><br><span class="line">                &#123;</span><br><span class="line">                    Log.v(TAG, &quot;1st wirte had readly&quot;);</span><br><span class="line">                    setProgressBarIndeterminateVisibility(true);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    private void init()</span><br><span class="line">    &#123;</span><br><span class="line">        // BLE check</span><br><span class="line">        if (!BleUtil.isBLESupported(this))</span><br><span class="line">        &#123;</span><br><span class="line">            Toast.makeText(this, R.string.ble_not_supported, Toast.LENGTH_SHORT)</span><br><span class="line">                    .show();</span><br><span class="line">            finish();</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        // BT check</span><br><span class="line">        BluetoothManager manager = BleUtil.getManager(this);</span><br><span class="line">        if (manager != null)</span><br><span class="line">        &#123;</span><br><span class="line">            mBTAdapter = manager.getAdapter();</span><br><span class="line">        &#125;</span><br><span class="line">        if (mBTAdapter == null)</span><br><span class="line">        &#123;</span><br><span class="line">            Toast.makeText(this, R.string.bt_unavailable, Toast.LENGTH_SHORT)</span><br><span class="line">                    .show();</span><br><span class="line">            finish();</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        // check BluetoothDevice</span><br><span class="line">        if (mDevice == null)</span><br><span class="line">        &#123;</span><br><span class="line">            mDevice = getBTDeviceExtra();</span><br><span class="line">            if (mDevice == null)</span><br><span class="line">            &#123;</span><br><span class="line">                finish();</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        // button disable</span><br><span class="line">        mReadManufacturerNameButton.setEnabled(false);</span><br><span class="line">        mReadSerialNumberButton.setEnabled(false);</span><br><span class="line">        mWriteAlertLevelButton.setEnabled(false);</span><br><span class="line"> </span><br><span class="line">        // connect to Gatt</span><br><span class="line">        if ((mConnGatt == null)</span><br><span class="line">                &amp;&amp; (mStatus == BluetoothProfile.STATE_DISCONNECTED))</span><br><span class="line">        &#123;</span><br><span class="line">            Log.v(TAG, &quot;try to connect with connectGatt&quot;);</span><br><span class="line">            // try to connect</span><br><span class="line">            mConnGatt = mDevice.connectGatt(this, false, mGattcallback);</span><br><span class="line">            mStatus = BluetoothProfile.STATE_CONNECTING;</span><br><span class="line">        &#125; else</span><br><span class="line">        &#123;</span><br><span class="line">            if (mConnGatt != null)</span><br><span class="line">            &#123;</span><br><span class="line">                // re-connect and re-discover Services</span><br><span class="line">                Log.v(TAG, &quot;try to connect with connect...&quot;);</span><br><span class="line">                mConnGatt.connect();</span><br><span class="line">                mConnGatt.discoverServices();</span><br><span class="line">            &#125; else</span><br><span class="line">            &#123;</span><br><span class="line">                Log.e(TAG, &quot;state error&quot;);</span><br><span class="line">                finish();</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        setProgressBarIndeterminateVisibility(true);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    private BluetoothAdapter mBluetoothAdapter;</span><br><span class="line">     </span><br><span class="line">    // 读取一个固定的mac 地址， 进行验证</span><br><span class="line">    private static final String BLUETOOTH_DEVICE_MAC = &quot;D0:06:8E:75:56:16&quot;;</span><br><span class="line"> </span><br><span class="line">    private BluetoothDevice getBTDeviceExtra()</span><br><span class="line">    &#123;</span><br><span class="line">        BluetoothDevice bleDevice = null;</span><br><span class="line">        Intent intent = getIntent();</span><br><span class="line">        if (intent == null)</span><br><span class="line">        &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        Bundle extras = intent.getExtras();</span><br><span class="line">        if (extras == null)</span><br><span class="line">        &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();</span><br><span class="line">        mBluetoothAdapter.startDiscovery();</span><br><span class="line"> </span><br><span class="line">        Set&lt;BluetoothDevice&gt; bledevices = mBluetoothAdapter.getBondedDevices();</span><br><span class="line">        if (bledevices.size() &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            for (BluetoothDevice bluetoothDevice : bledevices)</span><br><span class="line">            &#123;</span><br><span class="line">                Log.v(TAG,</span><br><span class="line">                        &quot;bletoothdevice mac address: &quot;</span><br><span class="line">                                + bluetoothDevice.getAddress());</span><br><span class="line">                if (bluetoothDevice.getAddress().toString()</span><br><span class="line">                        .equals(BLUETOOTH_DEVICE_MAC))</span><br><span class="line">                &#123;</span><br><span class="line">                    bleDevice = bluetoothDevice;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        return bleDevice;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://www.jianshu.com/u/4215db84d54e">JianShu</a></li>
         
          <li><a href="https://github.com/LavenderStream">GitHub</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Android-Bluetooth-Low-Energy-数据的写入与读取-第二天"><span class="toc-number">1.</span> <span class="toc-text">Android Bluetooth Low Energy 数据的写入与读取 第二天</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&text=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&is_video=false&description=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Android -- Android Bluetooth Low Energy 学习笔记&body=Check out this article: https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&title=Android -- Android Bluetooth Low Energy 学习笔记"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://lavenderstream.github.io/2015/12/29/Android-Android-Bluetooth-Low-Energy-学习笔记/&name=Android -- Android Bluetooth Low Energy 学习笔记&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Tiny
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://www.jianshu.com/u/4215db84d54e">JianShu</a></li>
         
          <li><a href="https://github.com/LavenderStream">GitHub</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


